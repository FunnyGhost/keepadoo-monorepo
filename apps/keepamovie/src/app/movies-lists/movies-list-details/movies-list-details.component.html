<div class="container">
  <section class="top-buttons">
    <button class="back-button" (click)="goBack()">
      <span>Back</span>
    </button>
    <button class="edit-button" (click)="edit()" *ngIf="(editMode$ | async) === false">
      <span> Edit </span>
    </button>
    <button class="done-button" (click)="done()" *ngIf="(editMode$ | async) === true">
      <span> Done </span>
    </button>
  </section>
  <ng-container *ngIf="isLoading$ | async; else moviesTemplate">
    <div class="loading-container">
      <img class="loading-image" src="/assets/spinner.svg" alt="" />
    </div>
  </ng-container>
  <ng-template #moviesTemplate>
    <h1 *ngIf="selectedList$ | async as selectedList">
      {{ selectedList.name }}
    </h1>

    <section class="movies" *ngIf="movies$ | async as movies">
      <keepadoo-movie
        *ngFor="let movie of movies"
        [movie]="movie"
        [editMode]="editMode$ | async"
        (delete)="deleteMovie($event)"
      ></keepadoo-movie>
      <section *ngIf="movies.length === 0" class="helper-section">
        <span class="helper-text"
          >Please use the
          button bellow to add your first movie to this list. Magical!</span
        >
      </section>
    </section>

    <section class="delete-area" *ngIf="(editMode$ | async) === true">
      <button class="delete-button" (click)="askForDeleteConfirmation()">Delete list</button>

      <keepadoo-dialog [(visible)]="showConfirmationDialog">
        <h4>Are you sure you want to delete this list?</h4>
        <section class="dialog-buttons">
          <button class="button-yes" (click)="deleteList()">Yes</button>
          <button class="button-no" (click)="cancelListDeletion()">No</button>
        </section>
      </keepadoo-dialog>
    </section>
  </ng-template>
</div>
